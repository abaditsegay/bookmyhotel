#!/bin/bash
set -e

echo "ğŸ‰ BookMyHotel Backend is Successfully Deployed Locally!"
echo "================================================================"
echo ""
echo "âœ… Services Status:"
docker-compose -f infra/docker-compose.yml ps

echo ""
echo "ğŸŒ Available Endpoints:"
echo "   ğŸ“Š Health Check:      http://localhost:8080/actuator/health"
echo "   ğŸ”§ Actuator Metrics:  http://localhost:8080/actuator/metrics"
echo "   ğŸ“ˆ Prometheus:        http://localhost:8080/actuator/prometheus"
echo "   ğŸ¨ Hotels API:        http://localhost:8080/api/hotels"
echo "   ğŸ“ Reservations API:  http://localhost:8080/api/reservations"
echo "   ğŸ‘¤ Users API:         http://localhost:8080/api/users"
echo "   ğŸ¢ Tenants API:       http://localhost:8080/api/tenants"

echo ""
echo "ğŸ—„ï¸  Database Access:"
echo "   ğŸ“ Host:              localhost:3307"
echo "   ğŸ‘¤ Username:          root"
echo "   ğŸ”‘ Password:          password"
echo "   ğŸ¦ Database:          bookmyhotel"

echo ""
echo "ğŸ§ª Test Commands:"
echo "   ğŸ¥ Health Check:      curl http://localhost:8080/actuator/health"
echo "   ğŸ“Š Metrics:           curl http://localhost:8080/actuator/metrics"
echo "   ğŸ”’ API Test:          curl http://localhost:8080/api/tenants"

echo ""
echo "ğŸ› ï¸  Management Commands:"
echo "   ğŸ“‹ View Logs:         docker-compose -f infra/docker-compose.yml logs -f backend"
echo "   ğŸ”„ Restart Backend:   docker-compose -f infra/docker-compose.yml restart backend"
echo "   ğŸ›‘ Stop Services:     docker-compose -f infra/docker-compose.yml down"
echo "   ğŸ› Debug Shell:       docker-compose -f infra/docker-compose.yml exec backend sh"

echo ""
echo "ğŸ¨ Available Tenants (from V19 migration):"
echo "   ğŸ¨ Grand Plaza Hotels (f47ac10b-58cc-4372-a567-0e02b2c3d479)"
echo "   ğŸ–ï¸  Coastal Resorts (a1b2c3d4-e5f6-4a5b-8c9d-1e2f3a4b5c6d)"
echo "   ğŸ™ï¸  Urban Suites (b2c3d4e5-f6a7-4b6c-9d0e-2f3a4b5c6d7e)"

echo ""
echo "ğŸ‘¥ Test Users (password for all: 'password'):"
echo "   ğŸ¨ Hotel Admin:       admin@grandplaza.com"
echo "   ğŸª Front Desk:        frontdesk@grandplaza.com"
echo "   ğŸ‘¤ Guest:             guest1@grandplaza.com"

echo ""
echo "ğŸ“Š Database Information:"
echo "   ğŸ“ˆ Applied Migrations: V1 through V19"
echo "   ğŸ¨ Sample Hotels:      Available with rooms and bookings"
echo "   ğŸ‘¥ Test Users:         Available across multiple tenants"
echo "   ğŸ“ Sample Data:        Hotels, rooms, users, and reservations"

echo ""
echo "âš ï¸  Configuration Notes:"
echo "   ğŸ“§ Email Service:      Not configured (optional)"
echo "   ğŸ’³ Stripe Payments:    Not configured (optional)"
echo "   ğŸ”‘ JWT Secret:         Using default development key"
echo "   ğŸ³ Container Logs:     Available in /app/logs volume"

echo ""
echo "ğŸ¯ Next Steps:"
echo "   1. Start your frontend: cd frontend && npm start"
echo "   2. Open your browser:   http://localhost:3000"
echo "   3. Use test credentials above to login"
echo "   4. Test multi-tenant functionality"

echo ""
echo "âœ… Backend deployment completed successfully!"
echo "   Backend API: http://localhost:8080"
echo "   Database:    localhost:3307"
echo ""
